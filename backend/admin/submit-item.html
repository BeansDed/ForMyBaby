<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Add Item</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(145deg, #fef2f2, #fee2e2);
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    h1 { color: #e11d48; margin-bottom: 10px; }
    .subtitle { color: #666; margin-bottom: 30px; }
    
    .nav-buttons {
      margin-bottom: 30px;
      display: flex;
      gap: 10px;
    }
    .nav-btn {
      padding: 10px 20px;
      background: #f43f5e;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .tab {
      padding: 12px 24px;
      background: #fee2e2;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }
    .tab.active { background: #f43f5e; color: white; }
    
    .form-section {
      display: none;
    }
    .form-section.active { display: block; }
    
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid #fee2e2;
      border-radius: 8px;
      font-size: 16px;
    }
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .submit-btn {
      width: 100%;
      padding: 15px;
      background: #f43f5e;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
    }
    .submit-btn:hover { background: #e11d48; }
    .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }
    
    #feedback {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      display: none;
    }
    .success { background: #d1fae5; color: #065f46; }
    .error { background: #fee2e2; color: #991b1b; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üíï Add New Content</h1>
    <p class="subtitle">Create memories, notes, bucket list items, or letters</p>
    
    <div class="nav-buttons">
      <a href="/admin/admin-dashboard.html" class="nav-btn">‚Üê Back to Dashboard</a>
    </div>
    
    <div class="tabs">
      <button class="tab active" onclick="showForm('memory')">Memory üì∏</button>
      <button class="tab" onclick="showForm('note')">Note üìù</button>
      <button class="tab" onclick="showForm('bucket')">Bucket List ‚ú®</button>
      <button class="tab" onclick="showForm('letter')">Letter üíå</button>
    </div>
    
    <!-- Memory Form -->
    <div id="memory-form" class="form-section active">
      <h2>Add Memory</h2>
      <form id="memoryForm" onsubmit="submitMemory(event)">
        <div class="form-group">
          <label>Title *</label>
          <input type="text" name="title" required>
        </div>
        <div class="form-group">
          <label>Description *</label>
          <textarea name="description" required></textarea>
        </div>
        <div class="form-group">
          <label>Image URL</label>
          <input type="url" name="imageUrl">
        </div>
        <div class="form-group">
          <label>Date *</label>
          <input type="date" name="date" required>
        </div>
        <button type="submit" class="submit-btn">Add Memory</button>
      </form>
    </div>
    
    <!-- Note Form -->
    <div id="note-form" class="form-section">
      <h2>Add Note</h2>
      <form id="noteForm" onsubmit="submitNote(event)">
        <div class="form-group">
          <label>Content *</label>
          <textarea name="content" required></textarea>
        </div>
        <div class="form-group">
          <label>Emoji</label>
          <input type="text" name="emoji" placeholder="üíï" maxlength="5">
        </div>
        <button type="submit" class="submit-btn">Add Note</button>
      </form>
    </div>
    
    <!-- Bucket List Form -->
    <div id="bucket-form" class="form-section">
      <h2>Add Bucket List Item</h2>
      <form id="bucketForm" onsubmit="submitBucketItem(event)">
        <div class="form-group">
          <label>Title *</label>
          <input type="text" name="title" required>
        </div>
        <div class="form-group">
          <label>Category</label>
          <select name="category">
            <option>Travel</option>
            <option>Romance</option>
            <option>Adventure</option>
            <option>Life Goals</option>
            <option>Activities</option>
            <option selected>Other</option>
          </select>
        </div>
        <button type="submit" class="submit-btn">Add Bucket List Item</button>
      </form>
    </div>
    
    <!-- Letter Form -->
    <div id="letter-form" class="form-section">
      <h2>Add Open When Letter</h2>
      <form id="letterForm" onsubmit="submitLetter(event)">
        <div class="form-group">
          <label>Occasion *</label>
          <input type="text" name="occasion" required placeholder="e.g., When you miss me">
        </div>
        <div class="form-group">
          <label>Content *</label>
          <textarea name="content" required></textarea>
        </div>
        <div class="form-group">
          <label>Emoji</label>
          <input type="text" name="emoji" placeholder="üíå" maxlength="5">
        </div>
        <button type="submit" class="submit-btn">Add Letter</button>
      </form>
    </div>
    
    <div id="feedback"></div>
  </div>
  
  <script>
    const token = localStorage.getItem('adminToken');
    if (!token) {
      window.location.href = '/admin-login.html';
    }
    
    function showForm(type) {
      document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      
      document.getElementById(type + '-form').classList.add('active');
      event.target.classList.add('active');
    }
    
    async function submitMemory(e) {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);
      
      const payload = {
        title: data.get('title'),
        description: data.get('description'),
        imageUrl: data.get('imageUrl'),
        date: data.get('date'),
        submittedBy: 'boyfriend',
        approved: true
      };
      
      try {
        const res = await fetch('/api/memories', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(payload)
        });
        
        const result = await res.json();
        if (result.success) {
          showFeedback('Memory added successfully! ‚úÖ', 'success');
          form.reset();
        } else {
          showFeedback('Error: ' + result.error, 'error');
        }
      } catch (error) {
        showFeedback('Error: ' + error.message, 'error');
      }
    }
    
    async function submitNote(e) {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);
      
      const payload = {
        content: data.get('content'),
        emoji: data.get('emoji') || 'üíï',
        submittedBy: 'boyfriend',
        approved: true
      };
      
      try {
        const res = await fetch('/api/notes', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(payload)
        });
        
        const result = await res.json();
        if (result.success) {
          showFeedback('Note added successfully! ‚úÖ', 'success');
          form.reset();
        } else {
          showFeedback('Error: ' + result.error, 'error');
        }
      } catch (error) {
        showFeedback('Error: ' + error.message, 'error');
      }
    }
    
    async function submitBucketItem(e) {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);
      
      const payload = {
        title: data.get('title'),
        category: data.get('category'),
        submittedBy: 'boyfriend',
        approved: true
      };
      
      try {
        const res = await fetch('/api/bucket-list', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(payload)
        });
        
        const result = await res.json();
        if (result.success) {
          showFeedback('Bucket list item added! ‚úÖ', 'success');
          form.reset();
        } else {
          showFeedback('Error: ' + result.error, 'error');
        }
      } catch (error) {
        showFeedback('Error: ' + error.message, 'error');
      }
    }
    
    async function submitLetter(e) {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);
      
      const payload = {
        occasion: data.get('occasion'),
        content: data.get('content'),
        emoji: data.get('emoji') || 'üíå',
        submittedBy: 'boyfriend',
        approved: true
      };
      
      try {
        const res = await fetch('/api/open-when', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(payload)
        });
        
        const result = await res.json();
        if (result.success) {
          showFeedback('Letter added! ‚úÖ', 'success');
          form.reset();
        } else {
          showFeedback('Error: ' + result.error, 'error');
        }
      } catch (error) {
        showFeedback('Error: ' + error.message, 'error');
      }
    }
    
    function showFeedback(message, type) {
      const fb = document.getElementById('feedback');
      fb.textContent = message;
      fb.className = type;
      fb.style.display = 'block';
      
      setTimeout(() => {
        fb.style.display = 'none';
      }, 3000);
    }
  </script>
</body>
</html>

